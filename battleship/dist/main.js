(()=>{"use strict";function e(e){return{length:e,beenHit:0,hit:function(){this.beenHit++},isSunk:function(){return this.beenHit>=this.length}}}function a(e="computer"){return{player:e,playerBoard:{board:[...Array(10)].map((e=>Array(10).fill(null))),playedBoard:[...Array(10)].map((e=>Array(10).fill(null))),shipsAlive:0,placeShip:function(e,a,t,r){if("horizontal"===t)for(let t=0;t<r.length;t++)this.board[a][e+t]=r;else for(let t=0;t<r.length;t++)this.board[a+t][e]=r;this.shipsAlive++},receiveAttack:function(e,a){if(this.playedBoard[a][e])return;const t=this.board[a][e];t?(t.hit(),t.isSunk()&&this.shipsAlive--):this.board[a][e]=0,this.playedBoard[a][e]=1},allShipsSunk:function(){return!this.shipsAlive},playAvailable:function(){for(let e=0;e<10;e++)for(let a=0;a<10;a++)if(!this.playedBoard[e][a])return!0;return!1},canPlace:function(e,a,t,r){if("horizontal"===t){if(e+r.length-1>9)return!1;for(let t=0;t<r.length;t++)if(this.board[a][e+t])return!1}else{if(a+r.length-1>9)return!1;for(let t=0;t<r.length;t++)if(this.board[a+t][e])return!1}return!0},randomPlace:function(e){let a,t;const r=Math.floor(2*Math.random())?"horizontal":"vertical";do{a=Math.floor(10*Math.random()),t=Math.floor(10*Math.random())}while(!this.canPlace(a,t,r,e));this.placeShip(a,t,r,e)}},attack:function(e,a,t){e.receiveAttack(a,t)},randomCoord:function(e){if(!e.playAvailable())return;let a,t;do{a=Math.floor(10*Math.random()),t=Math.floor(10*Math.random())}while(e.playedBoard[t][a]);return{x:a,y:t}}}}function t(e,a){function t(e,a,t,r,o){e[r][o]&&document.querySelector(`${a} [data-x="${o}"][data-y="${r}"]`).classList.add(t)}for(let r=0;r<10;r++)for(let o=0;o<10;o++)t(a.playerBoard.playedBoard,".computer","played",r,o),t(e.playerBoard.playedBoard,".player","played",r,o),t(e.playerBoard.board,".player","ship",r,o)}function r(e,a){const t=document.querySelector(a);for(let a=0;a<10;a++)for(let r=0;r<10;r++){const o=document.createElement("div");o.classList.add("cell"),o.dataset.x=r,o.dataset.y=a,e.playerBoard.board[a][r]&&o.classList.add("ship"),t.appendChild(o)}}!function(){const o=a("1"),l=a("computer");l.playerBoard.randomPlace(e(5)),l.playerBoard.randomPlace(e(4)),l.playerBoard.randomPlace(e(3)),l.playerBoard.randomPlace(e(3)),l.playerBoard.randomPlace(e(2)),document.querySelector(".container.player"),r(o,".container.player"),r(l,".container.computer"),async function(a,r){const o=document.getElementById("alignment-button");let l=!1,n="horizontal";o.addEventListener("click",(()=>{n=l?"horizontal":"vertical",l=!l,console.log(n)}));const i=[2,3,3,4,5];for(;a.playerBoard.shipsAlive<i.length;){const o=i[a.playerBoard.shipsAlive];let l;do{l=await new Promise((e=>{const a=document.querySelectorAll(".container.player .cell");function t(r){const o=r.target,l=Number(o.dataset.x),n=Number(o.dataset.y);a.forEach((e=>{e.removeEventListener("click",t)})),e({x:l,y:n})}a.forEach((e=>{e.addEventListener("click",t)}))}))}while(!a.playerBoard.canPlace(l.x,l.y,n,e(o)));console.log(l),a.playerBoard.placeShip(l.x,l.y,n,e(o)),t(a,r)}let c=!0;for(;!a.playerBoard.allShipsSunk()&&!r.playerBoard.allShipsSunk();){if(c){const e=await new Promise((e=>{const a=document.querySelectorAll(".container.computer .cell");function t(r){const o=r.target,l=Number(o.dataset.x),n=Number(o.dataset.y);a.forEach((e=>{e.removeEventListener("click",t)})),e({x:l,y:n})}a.forEach((e=>{e.addEventListener("click",t)}))}));r.playerBoard.playedBoard[e.y][e.x]||(a.attack(r.playerBoard,e.x,e.y),c=!c)}else{const e=r.randomCoord(a.playerBoard);r.attack(a.playerBoard,e.x,e.y),c=!c}t(a,r)}}(o,l)}()})();